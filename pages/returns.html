<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Index Returns</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1, h2 { color: #333; }
        /* Filter Styles */
        #filter-controls { margin-bottom: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9; display: flex; gap: 20px; align-items: center; }
        #filter-controls label { font-weight: bold; }
        #filter-controls input[type="number"] { padding: 5px; border: 1px solid #aaa; border-radius: 3px; width: 80px; text-align: center; }
        #filter-controls button { padding: 8px 15px; background-color: #4CAF50; color: white; border: none; border-radius: 3px; cursor: pointer; transition: background-color 0.3s; }
        #filter-controls button:hover { background-color: #45a049; }
        
        /* Table Styles */
        table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: right; }
        th { background-color: #f2f2f2; font-weight: bold; text-align: center; }
        .index-header { background-color: #e0e0e0; text-align: left; }
        .year-header { background-color: #c0c0c0; text-align: center; font-weight: bold; }
        .annual { background-color: #ffe0b2; font-weight: bold; }
        .positive { color: green; }
        .negative { color: red; }
        .current-year { background-color: #e6f7ff; }
        .ytd { font-style: italic; }
    </style>
</head>
<body>

    <h1>Stock Index Monthly & Annual Returns (2000-2025)</h1>

    <div id="filter-controls">
        <label for="startYear">Start Year:</label>
        <input type="number" id="startYear" min="2000" max="2025" value="2000">
        
        <label for="endYear">End Year:</label>
        <input type="number" id="endYear" min="2000" max="2025" value="2025">
        
        <button onclick="generateReturnsTable()">Apply Filter</button>
    </div>

    <div id="returns-table-container"></div>

    <script>
        const ALL_MONTHS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const indices = ['sp500', 'djia', 'nasdaq'];

        const data = {
            2000: { sp500: [-5.09, -1.98, 9.67, -3.08, -2.19, 2.39, -1.63, 6.07, -5.35, -0.48, -7.89, 0.41], djia: [-4.78, -0.48, 5.17, -4.77, -3.24, 2.34, -1.60, 6.18, -4.37, -0.35, -7.66, 0.92], nasdaq: [-3.23, 19.16, -2.64, -15.60, -11.90, 16.63, -5.04, 11.69, -12.70, -4.91, -22.89, -4.90] },
            2001: { sp500: [3.46, -9.23, -6.42, 7.68, 0.51, -2.56, -1.07, -6.40, -8.08, 1.80, 7.48, 0.76], djia: [3.61, -9.12, -6.18, 8.47, 0.25, -2.42, -0.77, -4.37, -7.12, 1.89, 7.98, 0.68], nasdaq: [12.21, -22.42, -14.51, 14.65, -0.30, -2.76, -1.00, -10.92, -17.04, 12.85, 14.17, 1.01] },
            2002: { sp500: [-1.46, -1.93, 3.67, -6.06, -0.74, -7.12, -7.90, 0.66, -10.87, 8.80, 5.89, -5.87], djia: [-0.91, -1.59, 3.79, -4.59, -0.57, -7.10, -7.53, 0.52, -10.69, 8.49, 6.04, -5.67], nasdaq: [-0.78, -10.46, 6.58, -8.53, -4.27, -9.43, -9.18, 1.28, -10.92, 13.49, 11.17, -9.73] },
            2003: { sp500: [-2.74, -1.50, 0.84, 8.10, 5.27, 1.28, 1.73, 1.92, -1.06, 5.64, 0.88, 5.24], djia: [-2.19, -1.35, 0.47, 7.88, 4.92, 1.18, 1.57, 2.09, -1.19, 5.50, 1.00, 4.98], nasdaq: [-1.07, -1.29, 0.29, 9.13, 9.03, 1.76, 6.90, 4.34, -1.30, 8.12, 1.53, 3.12] },
            2004: { sp500: [1.84, 1.39, -1.51, -1.57, 1.37, 1.95, -3.30, 0.42, 1.07, 1.52, 4.05, 3.36], djia: [2.16, 1.24, -0.90, -1.34, 1.31, 1.76, -3.00, 0.07, 1.49, 1.38, 4.55, 3.48], nasdaq: [3.08, 1.64, -1.77, -3.68, 3.51, 3.13, -7.80, -2.57, 3.34, 4.07, 6.21, 4.04] },
            2005: { sp500: [-2.50, 2.15, -1.77, -1.98, 3.21, 0.14, 3.65, -0.91, 0.77, -1.74, 3.71, 0.07], djia: [-2.65, 2.05, -2.14, -3.29, 3.77, -1.71, 3.56, -0.75, 0.99, -1.52, 3.51, 0.02], nasdaq: [-5.16, 0.58, -2.56, -3.89, 7.60, -0.19, 6.15, -1.73, 0.83, -2.35, 5.13, 2.25] },
            2006: { sp500: [2.65, 0.29, 1.23, 1.33, -2.90, 0.14, 0.63, 2.38, 2.58, 3.24, 1.84, 1.40], djia: [2.74, 0.05, 1.15, 2.38, -1.95, 0.02, 1.09, 1.93, 2.64, 3.36, 2.19, 1.32], nasdaq: [4.97, -0.96, 2.68, 0.86, -6.16, -0.48, -3.43, 3.07, 0.68, 5.36, 3.63, 1.46] },
            2007: { sp500: [1.51, -1.96, 1.11, 4.43, 3.48, -1.67, -3.10, 1.50, 3.71, 1.59, -4.18, -0.69], djia: [1.29, -1.97, 0.72, 4.91, 4.32, -1.59, -1.63, 1.01, 4.05, 4.40, -4.01, -0.59], nasdaq: [2.01, -1.86, 0.65, 4.29, 3.91, 0.06, -2.62, 2.63, 4.01, 5.68, -6.92, -0.84] },
            2008: { sp500: [-6.00, -3.25, -0.43, 4.88, 1.29, -8.43, -0.84, 1.45, -9.08, -16.80, -7.18, 0.78], djia: [-4.63, -3.00, -0.39, 4.90, -1.01, -10.15, -0.72, 1.62, -6.02, -14.10, -5.33, 0.87], nasdaq: [-9.89, -5.43, 0.29, 5.91, 4.55, -9.06, -1.13, 1.03, -11.68, -17.73, -10.77, 2.70] },
            2009: { sp500: [-8.43, -10.65, 8.76, 9.57, 5.59, 0.20, 7.56, 3.61, 3.73, -1.86, 6.00, 1.93], djia: [-8.84, -11.73, 7.70, 9.09, 4.07, 0.02, 8.82, 1.44, 2.28, -0.02, 6.54, 0.46], nasdaq: [-6.38, -6.68, 10.94, 12.40, 3.32, 3.42, 7.82, 1.67, 3.58, -0.52, 4.91, 5.81] },
            2010: { sp500: [-3.60, 3.10, 6.04, 1.60, -7.98, -5.24, 6.88, -4.51, 8.92, 3.88, 0.03, 6.68], djia: [-3.52, 2.87, 5.13, 1.44, -7.87, -3.62, 7.12, -4.31, 7.69, 3.11, -0.22, 6.30], nasdaq: [-5.37, 4.23, 7.14, 2.60, -8.30, -6.58, 6.90, -6.22, 12.04, 5.88, -0.38, 6.19] },
            2011: { sp500: [2.37, 3.43, 0.04, 2.96, -1.13, -1.67, -2.03, -5.43, -7.03, 10.93, -0.24, 0.88], djia: [2.73, 3.01, 0.82, 3.34, -1.95, -1.08, -0.72, -4.04, -6.01, 9.71, 0.75, 0.80], nasdaq: [1.84, 3.01, 0.00, 3.33, -1.31, -2.16, -1.00, -6.35, -6.44, 11.14, -0.32, -2.00] },
            2012: { sp500: [4.58, 4.33, 3.29, -0.61, -6.00, 4.10, 1.44, 2.35, 2.58, -1.81, 0.59, 0.91], djia: [3.43, 2.62, 2.14, -0.98, -6.17, 3.95, 1.34, 0.67, 2.59, -2.51, 0.53, 0.77], nasdaq: [8.01, 5.40, 4.17, -4.25, -7.22, 3.80, 0.98, 4.32, 1.52, -4.48, 1.13, -0.88] },
            2013: { sp500: [5.18, 1.36, 3.75, 1.93, 2.34, -1.31, 5.09, -2.93, 3.14, 4.60, 3.08, 2.54], djia: [6.00, 1.44, 3.66, 2.00, 2.21, -1.45, 4.95, -4.41, 2.18, 3.13, 3.54, 3.04], nasdaq: [4.11, 0.60, 3.42, 1.96, 3.82, -1.53, 6.51, -0.86, 5.10, 3.93, 3.98, 2.88] },
            2014: { sp500: [-3.43, 4.53, 0.80, 0.73, 2.35, 2.05, -1.37, 4.04, -1.40, 2.44, 2.66, -0.25], djia: [-5.30, 4.79, 0.76, 0.73, 0.80, 0.96, -1.56, 4.06, -0.33, 2.07, 2.51, -0.57], nasdaq: [-1.68, 5.71, -0.12, -1.65, 3.13, 2.65, -1.60, 4.88, -1.94, 3.11, 3.52, -0.23] },
            2015: { sp500: [-2.96, 5.75, -1.57, 1.00, 1.29, -1.94, 2.10, -6.03, -2.47, 8.44, 0.30, -1.58], djia: [-3.78, 6.00, -1.98, 0.39, 1.23, -2.18, 1.65, -6.57, -1.48, 8.47, 0.36, -1.66], nasdaq: [-2.00, 7.04, -1.27, 2.16, 3.00, -2.08, 2.79, -6.85, -2.74, 9.39, 1.08, -3.44] },
            2016: { sp500: [-4.96, -0.13, 6.78, 0.39, 1.80, 0.26, 3.69, 0.14, 0.02, -1.82, 3.70, 1.98], djia: [-5.47, 0.45, 7.13, 0.51, 0.02, 0.70, 2.67, 0.23, -0.48, -0.86, 5.41, 3.34], nasdaq: [-7.96, -1.51, 6.82, -1.99, 3.62, -2.09, 6.62, 1.25, 0.88, -2.17, 2.58, 1.13] },
            2017: { sp500: [1.90, 3.97, 0.12, 1.03, 1.41, 0.62, 2.06, 0.30, 2.06, 2.33, 3.07, 1.11], djia: [0.54, 4.82, 0.64, 1.27, 1.34, 1.62, 2.52, 0.37, 2.14, 4.34, 3.85, 1.85], nasdaq: [3.79, 3.74, -0.07, 2.30, 2.48, 1.05, 3.45, 0.64, 1.03, 3.64, 3.51, 0.42] },
            2018: { sp500: [5.73, -3.69, -2.54, 0.38, 2.41, 0.62, 3.72, 3.26, 0.57, -6.84, 2.04, -9.03], djia: [5.76, -4.28, -3.48, 0.28, 1.12, -0.60, 4.73, 2.16, 1.95, -5.07, 2.11, -8.69], nasdaq: [7.36, -1.90, -2.74, 0.04, 5.29, 0.92, 3.15, 5.73, -0.79, -9.20, 0.53, -9.48] },
            2019: { sp500: [8.01, 3.21, 1.94, 4.05, -6.35, 7.05, 1.44, -1.58, 1.87, 2.17, 3.63, 3.02], djia: [7.17, 3.67, 0.47, 2.62, -6.69, 7.19, 1.02, -1.70, 1.95, 0.48, 3.72, 1.74], nasdaq: [9.74, 3.44, 2.61, 4.74, -7.93, 7.42, 2.31, -2.62, 0.46, 3.66, 4.54, 3.54] },
            2020: { sp500: [-0.04, -8.23, -12.35, 12.82, 4.76, 1.99, 5.64, 7.19, -3.80, -2.66, 11.16, 3.84], djia: [-0.99, -9.58, -13.54, 11.08, 4.26, 1.72, 2.37, 7.58, -2.25, -4.55, 11.85, 3.25], nasdaq: [2.03, -6.41, -10.12, 15.45, 6.75, 6.01, 6.82, 9.59, -5.16, -2.23, 11.80, 5.71] },
            2021: { sp500: [-1.01, 2.76, 4.38, 5.34, 0.70, 2.33, 2.38, 3.04, -4.65, 7.01, -0.69, 4.48], djia: [-2.04, 3.17, 6.62, 2.72, 1.93, 0.08, 1.34, 1.22, -4.29, 5.84, -3.37, 5.38], nasdaq: [1.42, 0.93, 0.52, 5.40, -1.53, 5.49, 1.19, 4.00, -5.31, 6.95, 0.26, 0.74] },
            2022: { sp500: [-5.17, -2.99, 3.71, -8.72, 0.18, -8.25, 9.22, -3.96, -9.21, 8.10, 5.59, -5.76], djia: [-3.32, -3.02, 2.32, -4.82, 0.33, -6.56, 6.73, -3.96, -8.60, 13.95, 5.67, -4.17], nasdaq: [-8.78, -3.38, 3.41, -13.26, -2.05, -8.71, 12.35, -4.64, -10.50, 3.90, 4.37, -8.73] },
            2023: { sp500: [6.28, -2.44, 3.67, 1.56, 0.43, 6.61, 3.21, -1.59, -4.77, -2.10, 9.13, 4.54], djia: [2.83, -4.19, 1.89, 2.48, 0.37, 4.63, 3.35, -1.95, -3.50, 1.39, 8.77, 4.93], nasdaq: [10.68, -1.10, 6.69, 0.04, 5.93, 6.60, 4.05, -2.17, -5.81, -2.79, 10.70, 5.54] },
            2024: { sp500: [1.68, 5.34, 3.22, -4.16, 4.96, 3.59, 1.22, 2.43, 2.14, 1.01, 5.73, 2.38], djia: [1.25, 2.22, 2.11, -5.00, 2.30, 1.73, 4.45, 1.76, 1.85, 0.08, 7.54, 1.38], nasdaq: [1.47, 6.12, 1.77, -4.99, 6.90, 5.97, 1.13, 0.65, 2.70, 0.74, 4.90, 0.83] },
            2025: { sp500: [2.78, -1.30, -5.63, -0.68, 6.29, 5.09, 2.24, 1.90, 2.03, null], djia: [3.05, -1.78, -5.07, -1.81, 5.42, 4.31, 1.88, 3.11, 1.82, null], nasdaq: [2.98, -0.66, -7.44, 0.60, 8.23, 6.04, 2.44, 1.48, 2.16, null] }
        };

        /**
         * Calculates the compounded return.
         */
        function calculateCompoundedReturn(returns) {
            const validReturns = returns.filter(r => r !== null && r !== undefined);
            if (validReturns.length === 0) return 0;
            const cumulativeFactor = validReturns.reduce((acc, r) => acc * (1 + r / 100), 1);
            return (cumulativeFactor - 1) * 100;
        }

        /**
         * Formats a return value with color coding and percentage sign.
         */
        function formatReturn(value, isAnnual = false) {
            if (value === null || value === undefined) {
                return `<td class="annual ${isAnnual ? 'ytd-missing' : ''}">-</td>`;
            }
            const fixedValue = value.toFixed(2);
            const className = value >= 0 ? 'positive' : 'negative';
            const extraClass = isAnnual ? 'annual' : '';
            return `<td class="${className} ${extraClass}">${fixedValue}%</td>`;
        }

        /**
         * Generates the HTML table based on the start and end year filter.
         */
        function generateReturnsTable() {
            // 1. Get filter values
            const startYearInput = document.getElementById('startYear');
            const endYearInput = document.getElementById('endYear');
            
            const startYear = parseInt(startYearInput.value);
            const endYear = parseInt(endYearInput.value);

            // Basic validation
            if (isNaN(startYear) || isNaN(endYear) || startYear > endYear || startYear < 2000 || endYear > 2025) {
                document.getElementById('returns-table-container').innerHTML = '<p style="color:red;">Invalid year range. Please enter a valid start and end year (2000-2025), where start year is less than or equal to end year.</p>';
                return;
            }

            let html = '<table><thead>';
            
            // 2. Filter the years based on input
            const allYears = Object.keys(data).map(Number).sort((a, b) => a - b);
            const filteredYears = allYears.filter(year => year >= startYear && year <= endYear).map(String);
            
            const lastYearInData = allYears[allYears.length - 1].toString(); // 2025

            const maxMonths = ALL_MONTHS.length;

            // Table Header: Months and Annual/YTD
            html += '<tr><th class="year-header" rowspan="2">Year</th>';
            html += '<th class="index-header" rowspan="2">Index</th>';
            
            ALL_MONTHS.forEach(month => {
                html += `<th colspan="1">${month}</th>`;
            });
            html += '<th class="annual" rowspan="2">Annual / YTD</th></tr></thead><tbody>';

            // Table Body: Data Rows
            filteredYears.forEach(year => {
                const yearData = data[year];
                // Check against the actual last year in the data for YTD logic
                const isCurrentYear = year === lastYearInData; 

                indices.forEach((index, i) => {
                    const returns = yearData[index] || []; 
                    const compoundedReturn = calculateCompoundedReturn(returns);
                    
                    // Check for YTD based on available data length
                    const isYTD = isCurrentYear && returns.some(r => r === null || r === undefined);
                    
                    html += `<tr class="${isCurrentYear ? 'current-year' : ''}">`;

                    // Year Column: only on the first row for each year
                    if (i === 0) {
                        html += `<td class="year-header" rowspan="${indices.length}">${year}</td>`;
                    }

                    // Index Name
                    html += `<td class="index-header">${index.toUpperCase()}</td>`;

                    // Monthly Returns
                    for (let monthIndex = 0; monthIndex < maxMonths; monthIndex++) {
                        const monthlyReturn = returns[monthIndex];
                        html += formatReturn(monthlyReturn);
                    }

                    // Annual / YTD Return
                    html += formatReturn(compoundedReturn, true);
                    
                    html += '</tr>';
                });
                
                // Add YTD note for the last filtered year, if it's the current (incomplete) year
                if (isCurrentYear) {
                    html += `<tr><td colspan="${maxMonths + 3}" class="ytd" style="text-align:center;">* Annual return for ${year} is calculated as YTD (Year-to-Date) based on available data.</td></tr>`;
                }
            });

            html += '</tbody></table>';
            document.getElementById('returns-table-container').innerHTML = html;
        }

        // Initial table load
        document.addEventListener('DOMContentLoaded', generateReturnsTable);
    </script>

</body>
</html>